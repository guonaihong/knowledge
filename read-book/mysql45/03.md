## 事务隔离

- **事务**：保证一组数据库操作要么全部成功，要么全部失败。
- **事务支持**：在MySQL的InnoDB引擎中实现。

### 隔离性与隔离级别

- **ACID属性**：原子性(Atomicity)、一致性(Consistency)、隔离性(Isolation)、持久性(Durability)。
- **隔离级别**：
  - 读未提交（Read Uncommitted）
  - 读提交（Read Committed）
  - 可重复读（Repeatable Read）
  - 串行化（Serializable）

### 隔离级别的行为差异

- **读未提交**：事务未提交的变更对其他事务可见。
- **读提交**：事务提交后变更对其他事务可见。
- **可重复读**：事务执行期间看到的数据与启动时一致。
- **串行化**：读写操作通过加锁避免并行访问。

### 事务隔离的实现

- **多版本并发控制(MVCC)**：每条记录更新时记录回滚操作，支持不同版本的数据。
- **Read-view**：不同时刻启动的事务有不同的视图，用于读取数据。

### 长事务的影响

- **存储空间占用**：长事务导致回滚日志长时间保留，占用存储空间。
- **锁资源占用**：长事务可能长时间占用锁资源，影响数据库性能。

### 事务的启动方式

- **显式启动**：使用`BEGIN`或`START TRANSACTION`语句。
- **隐式启动**：
  - 设置`autocommit=0`，关闭自动提交。
  - 使用`COMMIT WORK AND CHAIN`提交并自动启动下一个事务。

### 配置MySQL隔离级别

- **设置方法**：通过启动参数`transaction-isolation`设置隔离级别。

### 避免长事务的策略

- **避免使用长事务**：减少回滚日志和锁资源的占用。
- **监控长事务**：使用`information_schema.innodb_trx`表查询长事务。

### 问题讨论

- **业务开发与数据库管理**：作为负责人，如何避免或处理长事务问题？

### 备份策略

- **一天一备 vs 一周一备**：权衡恢复时间与存储成本。

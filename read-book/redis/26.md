# 缓存异常问题及解决方案

## 缓存雪崩

### 表现：大量请求无法在Redis缓存中处理，导致数据库压力激增

* 原因：
  * 大量数据同时过期。
  * Redis缓存实例故障。

### 解决方案

* 避免设置相同的过期时间，使用随机数微调。
* 服务降级，区分核心与非核心数据的处理。
* 服务熔断，暂停接口访问，防止连锁反应。
* 请求限流，控制进入系统的请求数量。

## 缓存击穿

* 表现：热点数据失效，大量请求直接发送到数据库。
* 原因：热点数据过期失效。
* 解决方案：
  * 不给热点数据设置过期时间，永久保留在缓存中。

## 缓存穿透

### 表现：请求访问的数据既不在缓存中，也不在数据库中

### 原因

* 业务层误操作导致数据被误删除。
* 恶意攻击访问不存在的数据。

### 解决方案

* 缓存空值或缺省值，避免数据库查询。
* 使用布隆过滤器快速判断数据是否存在。
* 请求入口前端进行请求检测，过滤恶意请求。

## 预防式方案

合理设置数据过期时间。
搭建高可靠的缓存集群。
对于热点数据，不设置过期时间。
入口前端实现恶意请求检测，规范数据删除操作。

## 有损方案

服务熔断：暂停缓存系统服务，影响范围大。
服务降级：部分数据请求得到错误返回，无法正常处理。
请求限流：降低系统吞吐率，影响用户体验。

## 总结

缓存异常问题需综合考虑预防和应对措施，优先采用预防式方案以避免对业务产生负面影响。在不可避免的情况下，合理使用有损方案以保证系统稳定。

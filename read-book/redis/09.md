知识点总结

## 1. Redis数据存储与部署

数据量: 5000万个键值对，每个键值对约512B，总计约25GB。
云主机内存选择: 初步选择32GB内存云主机，预留7GB空间。

## 2. Redis持久化与性能问题

RDB持久化: 使用fork子进程，数据量大时，fork操作耗时，阻塞主线程。
性能影响: 大数据量导致latestfork_usec指标高，响应变慢。

## 3. Redis切片集群（分片集群）

概念: 多个Redis实例组成集群，数据按规则划分，每个实例保存一部分数据。
优势: 减少对主线程的阻塞，提高响应速度。

## 4. 纵向扩展与横向扩展

纵向扩展: 增加单个实例的资源配置，如内存和磁盘。
横向扩展: 增加Redis实例数量，通过分片集群实现。

## 5. RedisCluster方案

哈希槽: 采用哈希槽映射数据和实例，共有16384个哈希槽。
映射规则: 通过CRC16算法和取模运算确定键值对映射的哈希槽。

## 6. 数据切片与实例分布

手动分配: 根据实例资源配置手动分配哈希槽，避免容量压力不均。

## 7. 客户端定位数据

计算哈希槽: 客户端通过计算确定键值对的哈希槽。
实例信息获取: 实例将哈希槽信息发送给客户端，客户端本地缓存。

## 8. 处理哈希槽变化

MOVED命令: 实例返回新实例地址，客户端更新本地缓存并重定向请求。
ASK命令: 指示客户端数据迁移中，需发送ASKING命令后再次请求。

## 9. RedisCluster方案的优势

横向扩展性: 适应大数据量，易于扩展。
负载均衡: 通过数据重新分布实现。

## 10. 其他切片集群方案

ShardedJedis: 基于客户端分区。
CoiTwemproxy: 基于代理的方案。

## 11. 问答环节

问题: 使用哈希槽的好处是什么？为什么Redis不使用直接的键值对与实例对应表？

## 12. 课程小结

切片集群: 解决大数据量存储问题的有效方案。
横向扩展: 应对数据量增大的挑战。
命令处理: MOVED和ASK命令解决实例变化和数据迁移问题。
